<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kasir Pro - Sistem Kasir Usaha Kecil</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Splash Screen */
        #splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        .logo {
            width: 120px;
            height: 120px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
            box-shadow: 0 0 0 10px rgba(255,255,255,0.2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 20px rgba(255, 255, 255, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
        }

        .logo-text {
            color: white;
            font-size: 32px;
            font-weight: bold;
            margin-top: 20px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        /* Login Page */
        #loginPage {
            display: none;
            min-height: 100vh;
            padding: 20px;
            justify-content: center;
            align-items: center;
        }

        .login-container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 400px;
            width: 100%;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
            color: white;
            margin: 0 auto 20px;
        }

        h2 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        /* Main App */
        #mainApp {
            display: none;
            min-height: 100vh;
        }

        .navbar {
            background: white;
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .navbar-logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .navbar-menu {
            display: flex;
            gap: 20px;
        }

        .nav-btn {
            padding: 10px 20px;
            background: transparent;
            border: none;
            color: #555;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .nav-btn:hover, .nav-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .logout-btn {
            padding: 10px 20px;
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
        }

        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .page {
            display: none;
            animation: fadeIn 0.5s;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            margin-right: 5px;
        }

        .btn-edit {
            background: #ffa502;
            color: white;
        }

        .btn-delete {
            background: #ff4757;
            color: white;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            margin-top: 10px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .chart-container {
            width: 100%;
            height: 300px;
            background: #f8f9fa;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
        }

        .transaction-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash">
        <div class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
        </div>
        <div class="logo-text">Kasir Pro</div>
    </div>

    <!-- Login Page -->
    <div id="loginPage">
        <div class="login-container">
            <div class="login-logo">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <path d="M16 10a4 4 0 0 1-8 0"></path>
                </svg>
            </div>
            <h2>Login Admin</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="username" placeholder="Masukkan username" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="password" placeholder="Masukkan password" required>
                </div>
                <button type="submit" class="btn">Masuk</button>
            </form>
            <p style="text-align: center; margin-top: 15px; color: #999; font-size: 12px;">
                Default: admin / admin123
            </p>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp">
        <!-- Navbar -->
        <nav class="navbar">
            <div class="navbar-brand">
                <div class="navbar-logo">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <path d="M16 10a4 4 0 0 1-8 0"></path>
                    </svg>
                </div>
                <span>Kasir Pro</span>
            </div>
            <div class="navbar-menu">
                <button class="nav-btn active" onclick="showPage('dashboard')">Dashboard</button>
                <button class="nav-btn" onclick="showPage('transaksi')">Transaksi</button>
                <button class="nav-btn" onclick="showPage('pengeluaran')">Pengeluaran</button>
                <button class="nav-btn" onclick="showPage('laporan')">Laporan</button>
                <button class="nav-btn" onclick="showPage('produk')">Produk</button>
                <button class="logout-btn" onclick="logout()">Keluar</button>
            </div>
        </nav>

        <div class="container">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Penjualan Hari Ini</div>
                        <div class="stat-value" id="todaySales">Rp 0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Pengeluaran Hari Ini</div>
                        <div class="stat-value" id="todayExpenses">Rp 0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Saldo Kas</div>
                        <div class="stat-value" id="cashBalance">Rp 0</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Grafik Penjualan 7 Hari Terakhir</div>
                    <div class="chart-container">
                        <span>Grafik akan ditampilkan di sini</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Transaksi Terbaru</div>
                    <div id="recentTransactions"></div>
                </div>
            </div>

            <!-- Transaksi Page -->
            <div id="transaksi" class="page">
                <div class="card">
                    <div class="card-title">Input Transaksi Penjualan</div>
                    <form id="transactionForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Pilih Produk</label>
                                <select id="productSelect" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px;">
                                    <option value="">-- Pilih Produk --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Jumlah</label>
                                <input type="number" id="quantity" placeholder="Jumlah" min="1" required>
                            </div>
                            <div class="form-group">
                                <label>Harga Satuan</label>
                                <input type="number" id="price" placeholder="Harga" readonly>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Total</label>
                            <input type="text" id="total" placeholder="Total otomatis" readonly style="font-weight: bold; font-size: 18px;">
                        </div>
                        <button type="submit" class="btn-primary">Simpan Transaksi</button>
                    </form>
                </div>

                <div class="card">
                    <div class="card-title">Riwayat Transaksi Hari Ini</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Waktu</th>
                                <th>Produk</th>
                                <th>Jumlah</th>
                                <th>Harga</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody id="transactionHistory"></tbody>
                    </table>
                </div>
            </div>

            <!-- Pengeluaran Page -->
            <div id="pengeluaran" class="page">
                <div class="card">
                    <div class="card-title">Input Pengeluaran</div>
                    <form id="expenseForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Tanggal</label>
                                <input type="date" id="expenseDate" required>
                            </div>
                            <div class="form-group">
                                <label>Nominal</label>
                                <input type="number" id="expenseAmount" placeholder="Nominal" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Keterangan</label>
                            <input type="text" id="expenseDesc" placeholder="Keterangan pengeluaran" required>
                        </div>
                        <button type="submit" class="btn-primary">Simpan Pengeluaran</button>
                    </form>
                </div>

                <div class="card">
                    <div class="card-title">Riwayat Pengeluaran</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Keterangan</th>
                                <th>Nominal</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="expenseHistory"></tbody>
                    </table>
                </div>
            </div>

            <!-- Laporan Page -->
            <div id="laporan" class="page">
                <div class="card">
                    <div class="card-title">Filter Laporan</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Dari Tanggal</label>
                            <input type="date" id="reportFrom">
                        </div>
                        <div class="form-group">
                            <label>Sampai Tanggal</label>
                            <input type="date" id="reportTo">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button class="btn-primary" onclick="generateReport()">Tampilkan Laporan</button>
                        </div>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Pendapatan</div>
                        <div class="stat-value" id="reportIncome">Rp 0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Pengeluaran</div>
                        <div class="stat-value" id="reportExpense">Rp 0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Saldo</div>
                        <div class="stat-value" id="reportBalance">Rp 0</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Detail Laporan</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Jenis</th>
                                <th>Keterangan</th>
                                <th>Jumlah</th>
                            </tr>
                        </thead>
                        <tbody id="reportDetail"></tbody>
                    </table>
                </div>
            </div>

            <!-- Produk Page -->
            <div id="produk" class="page">
                <div class="card">
                    <div class="card-title">Tambah/Edit Produk</div>
                    <form id="productForm">
                        <input type="hidden" id="productId">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nama Produk</label>
                                <input type="text" id="productName" placeholder="Nama produk" required>
                            </div>
                            <div class="form-group">
                                <label>Harga</label>
                                <input type="number" id="productPrice" placeholder="Harga" required>
                            </div>
                            <div class="form-group">
                                <label>Stok Awal</label>
                                <input type="number" id="productStock" placeholder="Stok" required>
                            </div>
                        </div>
                        <button type="submit" class="btn-primary" id="productSubmitBtn">Tambah Produk</button>
                        <button type="button" class="btn-primary" onclick="cancelEdit()" id="cancelBtn" style="background: #999; display: none;">Batal</button>
                    </form>
                </div>

                <div class="card">
                    <div class="card-title">Daftar Produk</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Nama Produk</th>
                                <th>Harga</th>
                                <th>Stok</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="productList"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data Storage
        let products = [];
        let transactions = [];
        let expenses = [];
        let isLoggedIn = false;

        // Initialize
        window.onload = function() {
            setTimeout(() => {
                document.getElementById('splash').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('splash').style.display = 'none';
                    document.getElementById('loginPage').style.display = 'flex';
                }, 500);
            }, 2000);

            loadData();
            setTodayDate();
        };

        // Load data from memory
        function loadData() {
            updateProductSelect();
            updateProductList();
        }

        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('expenseDate').value = today;
            document.getElementById('reportFrom').value = today;
            document.getElementById('reportTo').value = today;
        }

        // Login
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === 'admin' && password === 'admin123') {
                isLoggedIn = true;
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                updateDashboard();
            } else {
                alert('Username atau password salah!');
            }
        });

        function logout() {
            if (confirm('Yakin ingin keluar?')) {
                isLoggedIn = false;
                document.getElementById('mainApp').style.display = 'none';
                document.getElementById('loginPage').style.display = 'flex';
                document.getElementById('loginForm').reset();
            }
        }

        // Navigation
        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById(pageName).classList.add('active');
            event.target.classList.add('active');

            if (pageName === 'dashboard') updateDashboard();
            if (pageName === 'transaksi') updateTransactionHistory();
            if (pageName === 'pengeluaran') updateExpenseHistory();
        }

        // Product Management
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const id = document.getElementById('productId').value;
            const name = document.getElementById('productName').value;
            const price = parseInt(document.getElementById('productPrice').value);
            const stock = parseInt(document.getElementById('productStock').value);

            if (id) {
                const product = products.find(p => p.id == id);
                product.name = name;
                product.price = price;
                product.stock = stock;
            } else {
                const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
                products.push({id: newId, name, price, stock});
            }

            this.reset();
            document.getElementById('productId').value = '';
            document.getElementById('productSubmitBtn').textContent = 'Tambah Produk';
            document.getElementById('cancelBtn').style.display = 'none';
            updateProductList();
            updateProductSelect();
        });

        function updateProductList() {
            const tbody = document.getElementById('productList');
            tbody.innerHTML = products.map(p => `
                <tr>
                    <td>${p.name}</td>
                    <td>Rp ${p.price.toLocaleString('id-ID')}</td>
                    <td>${p.stock}</td>
                    <td>
                        <button class="btn-small btn-edit" onclick="editProduct(${p.id})">Edit</button>
                        <button class="btn-small btn-delete" onclick="deleteProduct(${p.id})">Hapus</button>
                    </td>
                </tr>
            `).join('');
        }

        function updateProductSelect() {
            const select = document.getElementById('productSelect');
            select.innerHTML = '<option value="">-- Pilih Produk --</option>' + 
                products.map(p => `<option value="${p.id}">${p.name} - Rp ${p.price.toLocaleString('id-ID')} (Stok: ${p.stock})</option>`).join('');
        }

        function editProduct(id) {
            const product = products.find(p => p.id === id);
            document.getElementById('productId').value = product.id;
            document.getElementById('productName').value = product.name;
            document.getElementById('productPrice').value = product.price;
            document.getElementById('productStock').value = product.stock;
            document.getElementById('productSubmitBtn').textContent = 'Update Produk';
            document.getElementById('cancelBtn').style.display = 'inline-block';
        }

        function cancelEdit() {
            document.getElementById('productForm').reset();
            document.getElementById('productId').value = '';
            document.getElementById('productSubmitBtn').textContent = 'Tambah Produk';
            document.getElementById('cancelBtn').style.display = 'none';
        }

        function deleteProduct(id) {
            if (confirm('Yakin ingin menghapus produk ini?')) {
                products = products.filter(p => p.id !== id);
                updateProductList();
                updateProductSelect();
            }
        }

        // Transaction
        document.getElementById('productSelect').addEventListener('change', function() {
            const productId = parseInt(this.value);
            const product = products.find(p => p.id === productId);
            if (product) {
                document.getElementById('price').value = product.price;
                document.getElementById('quantity').value = 1;
                calculateTotal();
            }
        });

        document.getElementById('quantity').addEventListener('input', calculateTotal);

        function calculateTotal() {
            const quantity = parseInt(document.getElementById('quantity').value) || 0;
            const price = parseInt(document.getElementById('price').value) || 0;
            const total = quantity * price;
            document.getElementById('total').value = 'Rp ' + total.toLocaleString('id-ID');
        }

        document.getElementById('transactionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const productId = parseInt(document.getElementById('productSelect').value);
            const quantity = parseInt(document.getElementById('quantity').value);
            const product = products.find(p => p.id === productId);

            if (!product) {
                alert('Pilih produk terlebih dahulu!');
                return;
            }

            if (quantity > product.stock) {
                alert('Stok tidak mencukupi!');
                return;
            }

            product.stock -= quantity;

            const transaction = {
                id: Date.now(),
                date: new Date().toISOString(),
                productName: product.name,
                quantity: quantity,
                price: product.price,
                total: quantity * product.price
            };

            transactions.push(transaction);
            this.reset();
            updateProductList();
            updateProductSelect();
            updateTransactionHistory();
            updateDashboard();
            alert('Transaksi berhasil disimpan!');
        });

        function updateTransactionHistory() {
            const today = new Date().toDateString();
            const todayTransactions = transactions.filter(t => new Date(t.date).toDateString() === today);
            
            const tbody = document.getElementById('transactionHistory');
            tbody.innerHTML = todayTransactions.map(t => `
                <tr>
                    <td>${new Date(t.date).toLocaleTimeString('id-ID')}</td>
                    <td>${t.productName}</td>
                    <td>${t.quantity}</td>
                    <td>Rp ${t.price.toLocaleString('id-ID')}</td>
                    <td>Rp ${t.total.toLocaleString('id-ID')}</td>
                </tr>
            `).join('');
        }

        // Expenses
        document.getElementById('expenseForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const expense = {
                id: Date.now(),
                date: document.getElementById('expenseDate').value,
                amount: parseInt(document.getElementById('expenseAmount').value),
                description: document.getElementById('expenseDesc').value
            };

            expenses.push(expense);
            this.reset();
            setTodayDate();
            updateExpenseHistory();
            updateDashboard();
            alert('Pengeluaran berhasil disimpan!');
        });

        function updateExpenseHistory() {
            const tbody = document.getElementById('expenseHistory');
            tbody.innerHTML = expenses.map(e => `
                <tr>
                    <td>${new Date(e.date).toLocaleDateString('id-ID')}</td>
                    <td>${e.description}</td>
                    <td>Rp ${e.amount.toLocaleString('id-ID')}</td>
                    <td>
                        <button class="btn-small btn-delete" onclick="deleteExpense(${e.id})">Hapus</button>
                    </td>
                </tr>
            `).join('');
        }

        function deleteExpense(id) {
            if (confirm('Yakin ingin menghapus pengeluaran ini?')) {
                expenses = expenses.filter(e => e.id !== id);
                updateExpenseHistory();
                updateDashboard();
            }
        }

        // Dashboard
        function updateDashboard() {
            const today = new Date().toDateString();
            const todayTransactions = transactions.filter(t => new Date(t.date).toDateString() === today);
            const todayExpenses = expenses.filter(e => new Date(e.date).toDateString() === today);

            const todaySales = todayTransactions.reduce((sum, t) => sum + t.total, 0);
            const todayExpenseTotal = todayExpenses.reduce((sum, e) => sum + e.amount, 0);
            const totalSales = transactions.reduce((sum, t) => sum + t.total, 0);
            const totalExpenses = expenses.reduce((sum, e) => sum + e.amount, 0);

            document.getElementById('todaySales').textContent = 'Rp ' + todaySales.toLocaleString('id-ID');
            document.getElementById('todayExpenses').textContent = 'Rp ' + todayExpenseTotal.toLocaleString('id-ID');
            document.getElementById('cashBalance').textContent = 'Rp ' + (totalSales - totalExpenses).toLocaleString('id-ID');

            // Recent transactions
            const recentDiv = document.getElementById('recentTransactions');
            const recentTransactions = transactions.slice(-5).reverse();
            
            if (recentTransactions.length === 0) {
                recentDiv.innerHTML = '<p style="text-align: center; color: #999;">Belum ada transaksi</p>';
            } else {
                recentDiv.innerHTML = recentTransactions.map(t => `
                    <div class="transaction-item">
                        <div>
                            <strong>${t.productName}</strong><br>
                            <small>${new Date(t.date).toLocaleString('id-ID')}</small>
                        </div>
                        <div style="text-align: right;">
                            <strong>Rp ${t.total.toLocaleString('id-ID')}</strong><br>
                            <small>${t.quantity} item</small>
                        </div>
                    </div>
                `).join('');
            }
        }

        // Report
        function generateReport() {
            const fromDate = new Date(document.getElementById('reportFrom').value);
            const toDate = new Date(document.getElementById('reportTo').value);
            toDate.setHours(23, 59, 59, 999);

            const filteredTransactions = transactions.filter(t => {
                const tDate = new Date(t.date);
                return tDate >= fromDate && tDate <= toDate;
            });

            const filteredExpenses = expenses.filter(e => {
                const eDate = new Date(e.date);
                return eDate >= fromDate && eDate <= toDate;
            });

            const totalIncome = filteredTransactions.reduce((sum, t) => sum + t.total, 0);
            const totalExpense = filteredExpenses.reduce((sum, e) => sum + e.amount, 0);
            const balance = totalIncome - totalExpense;

            document.getElementById('reportIncome').textContent = 'Rp ' + totalIncome.toLocaleString('id-ID');
            document.getElementById('reportExpense').textContent = 'Rp ' + totalExpense.toLocaleString('id-ID');
            document.getElementById('reportBalance').textContent = 'Rp ' + balance.toLocaleString('id-ID');

            // Detail report
            const details = [];
            
            filteredTransactions.forEach(t => {
                details.push({
                    date: new Date(t.date),
                    type: 'Penjualan',
                    description: t.productName + ' (' + t.quantity + ' item)',
                    amount: t.total
                });
            });

            filteredExpenses.forEach(e => {
                details.push({
                    date: new Date(e.date),
                    type: 'Pengeluaran',
                    description: e.description,
                    amount: -e.amount
                });
            });

            details.sort((a, b) => b.date - a.date);

            const tbody = document.getElementById('reportDetail');
            if (details.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: #999;">Tidak ada data untuk periode ini</td></tr>';
            } else {
                tbody.innerHTML = details.map(d => `
                    <tr>
                        <td>${d.date.toLocaleDateString('id-ID')}</td>
                        <td><span style="color: ${d.type === 'Penjualan' ? '#10ac84' : '#ff4757'}; font-weight: 600;">${d.type}</span></td>
                        <td>${d.description}</td>
                        <td style="font-weight: 600; color: ${d.amount >= 0 ? '#10ac84' : '#ff4757'};">
                            ${d.amount >= 0 ? '+' : ''}Rp ${Math.abs(d.amount).toLocaleString('id-ID')}
                        </td>
                    </tr>
                `).join('');
            }
        }

        // Initialize dashboard on load
        updateDashboard();
    </script>
</body>
</html>